Fixed the bug and merging it back to master
